<%- include('../partials/cashierHeader.ejs'); -%>
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>My Transactions</title>
  <style>
/* ================================
   VARIABLES
================================ */
:root {
  --navy: #001f4d;
  --white: #ffffff;
  --light-gray: #f5f5f5;
  --border-gray: #dcdfe3;
}

/* ================================
   GLOBAL STYLES
================================ */
body {
  font-family: Arial, sans-serif;
  margin: 0;
  padding: 1rem;
  background-color: var(--light-gray);
  color: var(--navy);
}

h1 {
  text-align: center;
  margin-bottom: 1rem;
}

/* ================================
   FILTER FORM
================================ */
form {
  display: flex;
  flex-direction: column;
  gap: 0.5rem;
  margin-bottom: 1.5rem;
  background-color: var(--white);
  padding: 1rem;
  border-radius: 8px;
  box-shadow: 0 2px 4px rgba(0,0,0,0.1);
}

form label {
  display: flex;
  flex-direction: column;
  font-weight: bold;
  color: var(--navy);
}

form input {
  padding: 0.5rem;
  border: 1px solid var(--border-gray);
  border-radius: 4px;
  margin-top: 0.25rem;
}

form button {
  margin-top: 0.5rem;
  padding: 0.6rem;
  background-color: var(--navy);
  color: var(--white);
  border: none;
  border-radius: 4px;
  font-weight: bold;
  cursor: pointer;
}

form button:hover {
  background-color: #003366;
}

/* ================================
   TRANSACTIONS TABLE
================================ */
table {
  width: 100%;
  border-collapse: collapse;
  background-color: var(--white);
  border-radius: 8px;
  overflow: hidden;
  box-shadow: 0 2px 4px rgba(0,0,0,0.1);
}

thead {
  background-color: var(--navy);
  color: var(--white);
}

th, td {
  padding: 0.5rem;
  text-align: left;
  border-bottom: 1px solid var(--border-gray);
}

tbody tr:nth-child(even) {
  background-color: #f0f2f7;
}

tbody tr:hover {
  background-color: #e0e4f0;
}

td div {
  font-size: 0.9rem;
}

/* ================================
   MOBILE FIRST
================================ */
@media (min-width: 600px) {
  form {
    flex-direction: row;
    align-items: flex-end;
    gap: 1rem;
  }

  form label {
    flex: 1;
  }

  form button {
    flex-shrink: 0;
  }
}

@media (min-width: 768px) {
  table th, table td {
    padding: 0.75rem;
  }

  h1 {
    font-size: 2rem;
  }
}

@media (min-width: 1024px) {
  table {
    font-size: 0.95rem;
  }

  table th, table td {
    padding: 0.85rem;
  }

  form {
    max-width: 900px;
    margin: 0 auto 2rem;
  }

  table {
    max-width: 1000px;
    margin: 0 auto;
  }
}
</style>

</head>
<body>
  <h1>My Transactions</h1>

  <!-- Filter by date -->
  <form method="GET" action="/cashier/transactions">
    <label>
      Start Date:
      <input type="date" name="startDate" value="<%= startDate || '' %>">
    </label>
    <label>
      End Date:
      <input type="date" name="endDate" value="<%= endDate || '' %>">
    </label>
    <button type="submit">Filter</button>
  </form>

  <table border="1" cellpadding="8" cellspacing="0">
    <thead>
      <tr>
        <th>#</th>
        <th>Invoice</th>
        <th>Total Amount</th>
        <th>Status</th>
        <th>Date / Time</th>
        <th>Items</th>
      </tr>
    </thead>
    <tbody>
      <% if (!transactions || transactions.length === 0) { %>
        <tr>
          <td colspan="6">No transactions found.</td>
        </tr>
      <% } %>

      <% transactions.forEach((tx, index) => { %>
        <tr>
          <td><%= index + 1 %></td>
          <td><%= tx.invoice || '-' %></td>
          <td><%= tx.totalAmount || 0 %></td>
          <td><%= tx.status || '-' %></td>
          <td><%= tx.createdAt ? new Date(tx.createdAt).toLocaleString() : '-' %></td>
          <td>
            <% tx.items?.forEach(item => { %>
              <div><%= item.product?.name || 'Unknown' %> x <%= item.quantity %></div>
            <% }) %>
          </td>
        </tr>
      <% }) %>
    </tbody>
  </table>

</body>
</html>
